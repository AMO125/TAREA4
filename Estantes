from Book import *
from Pila import *
from csv import  *
from ListaBookOrden import *
from Scripts.Pila import Pila
from rich.console import Console
from rich.table import Table
from rich.panel import Panel


def crearLibro(fila):
    """"
     Crea un objeto book  a partir de los datos de una fila del archivo CSV.

    Args:
    fila (list): Una lista que contiene los datos de una fila del archivo CSV.

    Returns:
    Book, El objeto de contacto creado, o None si la fila está vacía.
    """
    try:
        titulo = fila[0]
        autor = fila[1]
        editorial = fila[2]
        anio = int(fila[3])
        book = Book(titulo, autor, editorial, anio)

        return book

    except (ValueError, IndexError) as e:
        print(f"Error al procesar la fila: {fila}")
        print(f"Error: {e}")
        return None  # Devolver None en caso de error

def apilar_Archivo(Pila: Pila, archivo_csv):
    try:
        with open(archivo_csv, newline='', encoding='utf-8') as csvfile:
            lector = csv.reader(csvfile)
            next(lector)
            for fila in lector:
                libro=crearLibro(fila)
                if libro is not None:
                    Pila.push(libro)
                    print(f"Libro agregado:")
    except FileNotFoundError:
        print(f"Error, no se encontró el archivo: {archivo_csv}")

if __name__=="__main__":
    Repisa1=Pila()
    Repisa2=Pila()
    RepisaOrdenada = None
    volver_al_menu = 's'
    while volver_al_menu.lower() == 's':
        # Mostramos las opciones del menu usando rich
        console = Console()

        table = Table(title="Menú de la biblioteca R2-Dato")
        table.add_column("Opción", style="cyan")
        table.add_column("Descripción")
